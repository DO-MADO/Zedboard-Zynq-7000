<!DOCTYPE html>
<html lang="ko">
<<<<<<< Updated upstream
  <head>
    <!-- ===================== [Meta & ê¸°ë³¸ ì„¤ì •] ===================== -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ì‹ í˜¸ì²˜ë¦¬ë³´ë“œ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</title>

    <!-- ===================== [í°íŠ¸ & ìŠ¤íƒ€ì¼] ===================== -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/style.css" />

    <!-- ===================== [ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬] ===================== -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
  </head>

  <body>
    <!-- ===================== [í—¤ë” ì˜ì—­] ===================== -->
    <header>
      <div class="brand">ì‹ í˜¸ì²˜ë¦¬ë³´ë“œ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ â€” Local Web</div>
      <div class="header-controls">
        <div class="muted" id="clock" aria-live="polite">â€”</div>
        <label class="switch">
          <input type="checkbox" id="themeToggleInput" />
          <span class="slider"></span>
        </label>

        <!-- README ë²„íŠ¼ -->
    <button id="readmeBtn" class="readme-btn">README</button>
 
      </div>
    </header>

    <!-- ===================== [ë©”ì¸ ì½˜í…ì¸ ] ===================== -->
    <main class="grid">
      <!-- [ì„¹ì…˜ 1: 8ì±„ë„ ì‹¤ì‹œê°„ ì°¨íŠ¸] -->
      <section class="card">
        <h2>8ch ì‹¤ì‹œê°„ ì°¨íŠ¸ (ì¤Œ/ë“œë˜ê·¸ ê°€ëŠ¥)</h2>
        <div class="toolbar">
          <div id="fig1Bar" class="legend-bar"></div>
          <button id="resetZoom1" class="btn">Zoom ë¦¬ì…‹ (ë”ë¸”í´ë¦­ ê°€ëŠ¥)</button>
=======
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì‹ í˜¸ ì²˜ë¦¬ ë³´ë“œ</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <!-- ===================== [í—¤ë” ì˜ì—­] ===================== -->
  <header>
    <div class="brand">
      <img src="/static/img/logo.png" alt="ë¡œê³ " class="brand-logo">
    </div>
    <div class="header-controls">
      <div id="statsDisplay" class="stats-display">
        </div>
    </div>
  </header>

  <!-- ===================== [ë©”ì¸ ì½˜í…ì¸ ] ===================== -->
  <main class="grid">
    

    <!-- ===================== [íƒ­ ë²„íŠ¼ ì˜ì—­] ===================== -->
    <div class="tabs">
      <button class="tab-btn" data-target="fig3-section">Configuration</button>
      <button class="tab-btn active" data-target="fig1-section">Raw Data</button>
      <button class="tab-btn" data-target="fig2-section">4ch</button>
    </div>

    <!-- ============================================================
      [ì„¹ì…˜ 1: 8ì±„ë„ ì‹¤ì‹œê°„ ì°¨íŠ¸]
      - ADC ì›ì‹ í˜¸(ë©€í‹°ì±„ë„) ì‹¤ì‹œê°„ í‘œì‹œ
      - ì±„ë„ë³„ on/off í† ê¸€ + ì¤Œ/ë“œë˜ê·¸ ì§€ì›
    ============================================================ -->
    <section id="fig1-section" class="card tab-content active">
      <!-- Stage3 -->
      <h2>Â· Raw Data (~Stage3)</h2>
      <div class="toolbar">
        <div id="fig1Bar" class="legend-bar"></div>

        <button id="dataReset1" class="btn">ë°ì´í„° ë¦¬ì…‹</button>
        <button id="resetZoom1" class="btn">Zoom ë¦¬ì…‹</button>

        <div style="flex-grow: 1;"></div>

        <div class="yaxis-controls">
          <label for="yMin1">Yì¶• Min:</label>
          <input type="number" id="yMin1" class="yaxis-input" placeholder="Min">
          <label for="yMax1">Max:</label>
          <input type="number" id="yMax1" class="yaxis-input" placeholder="Max">
          <button id="yApply1" class="btn">ë²”ìœ„ ì ìš©</button>
          <button id="yAuto1" class="btn">ìë™</button>
        </div>
      </div>

      <div class="chart-container">
        <canvas id="fig1"></canvas>
      </div>
    

      <!-- Stage5 -->
      <h2 style="margin-top: 32px;">Â· Raw Data (~Stage5)</h2>

      <div class="toolbar">
        <div id="fig3Bar" class="legend-bar"></div>

        <button id="dataReset3" class="btn">ë°ì´í„° ë¦¬ì…‹</button>
        <button id="resetZoom3" class="btn">Zoom ë¦¬ì…‹</button>

        <div style="flex-grow: 1;"></div>

        <div class="yaxis-controls">
          <label for="yMin3">Yì¶• Min:</label>
          <input type="number" id="yMin3" class="yaxis-input" placeholder="Min">
          <label for="yMax3">Max:</label>
          <input type="number" id="yMax3" class="yaxis-input" placeholder="Max">
          <button id="yApply3" class="btn">ë²”ìœ„ ì ìš©</button>
          <button id="yAuto3" class="btn">ìë™</button>
        </div>
      </div>

      <div class="chart-container">
         <canvas id="fig3"></canvas>
      </div>
    </section>

    <!-- ============================================================
      [ì„¹ì…˜ 2: íŒŒìƒ/ë³´ì • ì‹ í˜¸ + ê³„ìˆ˜ ì…ë ¥]
      - y1, y2, y3, yt ê³„ìˆ˜ê°’ì„ ì‹¤ì‹œê°„ ì…ë ¥/ì €ì¥ ê°€ëŠ¥
      - Derived/ë³´ì • ì‹ í˜¸ ê·¸ë˜í”„ í‘œì‹œ + on/off í† ê¸€ ì§€ì›
      - ê³„ìˆ˜ ë³€ê²½ ì‹œ ì„œë²„(postParams)ë¡œ ì „ì†¡ â†’ ì¦‰ì‹œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
    ============================================================ -->
    <section id="fig2-section" class="card tab-content">
      <h2>Â· 4ch</h2>

      <!-- --------------------- [ê³„ìˆ˜ ì œì–´ UI] --------------------- -->
      <div class="horizontal-controls">
        <div class="control-group">
          <label>ë‹¨ê³„</label>
          <select id="stage">
            <option value="yt" selected>yt</option>
          </select>
>>>>>>> Stashed changes
        </div>
        <canvas id="fig1"></canvas>
      </section>

<<<<<<< Updated upstream
      <!-- [ì„¹ì…˜ 2: íŒŒìƒ/ë³´ì • ì‹ í˜¸] -->
      <section class="card">
        <h2>íŒŒìƒ/ë³´ì • ì‹ í˜¸</h2>

        <!-- ì»¨íŠ¸ë¡¤ UI -->
        <div class="horizontal-controls">
          <div class="control-group">
            <label>ë‹¨ê³„</label>
            <select id="stage">
              <option value="yt" selected>yt</option>
            </select>
=======
        <div class="control-group">
          <label>í‘œì‹œ ëª¨ë“œ</label>
          <select id="multiSel">
            <option value="yt_4">yt 4ì±„ë„</option>
          </select>
        </div>

        <div style="width: 16px"></div>

        <div class="control-group">
          <label>y1 ë¶„ëª¨ ê³„ìˆ˜ [a5,a4,a3,a2,a1,a0]</label>
          <div class="coeffs">
            <input id="y1c" type="text" value="0,1,0" />
            <button class="btn" id="saveY1">ì ìš©</button>
>>>>>>> Stashed changes
          </div>

<<<<<<< Updated upstream
          <div class="control-group">
            <label>í‘œì‹œ ëª¨ë“œ</label>
            <select id="multiSel">
              <option value="yt_4">yt 4ì±„ë„</option>
            </select>
          </div>

          <div style="width: 16px"></div>

          <div class="control-group">
            <label>y1 ë¶„ëª¨ ê³„ìˆ˜ [a5,a4,a3,a2,a1,a0]</label>
            <div class="coeffs">
              <input id="y1c" type="text" value="0,1,0" />
              <button class="btn" id="saveY1">ì ìš©</button>
            </div>
          </div>

          <div class="control-group">
=======
        <div class="control-group">
>>>>>>> Stashed changes
          <label>y2 ê³„ìˆ˜ [b5,b4,b3,b2,b1,b0]</label>
          <div class="coeffs">
            <input id="y2c" type="text" value="0,0,0,-0.01,0.9,0" />
            <button class="btn" id="saveY2">ì ìš©</button>
          </div>
        </div>
<<<<<<< Updated upstream
          <div class="control-group">
            <label>y3 ê³„ìˆ˜ [c5,c4,c3,c2,c1,c0]</label>
            <div class="coeffs">
              <input id="y3c" type="text" value="0,1,0,0,0,0" />
              <button class="btn" id="saveY3">ì ìš©</button>
            </div>
          </div>
          <div class="control-group">
            <label>yt ê³„ìˆ˜[E,F]</label>
            <div class="coeffs">
              <input id="ytc" type="text" value="1,0" />
              <button class="btn" id="saveYt">ì ìš©</button>
            </div>
          </div>
        </div>

        <!-- ê·¸ë˜í”„ -->
        <div class="toolbar">
          <div id="fig2Bar" class="legend-bar"></div>
          <button id="resetZoom2" class="btn">Zoom ë¦¬ì…‹ (ë”ë¸”í´ë¦­ ê°€ëŠ¥)</button>
=======

        <div class="control-group">
          <label>y3 ê³„ìˆ˜ [c5,c4,c3,c2,c1,c0]</label>
          <div class="coeffs">
            <input id="y3c" type="text" value="0,1,0,0,0,0" />
            <button class="btn" id="saveY3">ì ìš©</button>
          </div>
        </div>

        <div class="control-group">
          <label>yt ê³„ìˆ˜ [E,F]</label>
          <div class="coeffs">
            <input id="ytc" type="text" value="1,0" />
            <button class="btn" id="saveYt">ì ìš©</button>
          </div>
>>>>>>> Stashed changes
        </div>
        <canvas id="fig2"></canvas>
      </section>

<<<<<<< Updated upstream
      <!-- [ì„¹ì…˜ 3: ì‹¤ì‹œê°„ íŒŒë¼ë¯¸í„°] -->
      <section class="card">
        <h2>ì‹¤ì‹œê°„ íŒŒë¼ë¯¸í„°</h2>

        <!-- ìŠ¬ë¼ì´ë” & ì…ë ¥ ë°•ìŠ¤ -->
        <div class="controls">
=======
      <!-- --------------------- [ê·¸ë˜í”„ ì˜ì—­] --------------------- -->
      <div class="toolbar">
        <div id="fig2Bar" class="legend-bar"></div>
        <button id="resetZoom2" class="btn">Zoom ë¦¬ì…‹ (ë”ë¸”í´ë¦­ ê°€ëŠ¥)</button>
      </div>
      <div class="chart-container">
         <canvas id="fig2"></canvas>
      </div>
    </section>

    <!-- ============================================================
      [ì„¹ì…˜ 3: ì‹¤ì‹œê°„ íŒŒë¼ë¯¸í„° ì œì–´]
      - LPF cutoff, Sampling Rate, Moving Avg, Block Size ì œì–´
      - ì ìš©/ì´ˆê¸°í™” ë²„íŠ¼ â†’ ì„œë²„ ë°˜ì˜
      - í˜„ì¬ íŒŒë¼ë¯¸í„° ìƒíƒœë¥¼ paramsViewì— í‘œì‹œ
    ============================================================ -->
    <section id="fig3-section" class="card tab-content">
      <h2>Â· Configuration</h2>

      <div class="controls">
        <div class="param">
>>>>>>> Stashed changes
          <label>LPF cutoff (Hz)</label>
          <input type="range" id="lpf" min="10" max="20000" step="10" />
          <input type="number" id="lpf_num" min="10" max="20000" step="10" style="width: 90px" />

<<<<<<< Updated upstream
          <label>CH Moving Avg (N)</label>
          <input type="range" id="ma_ch" min="1" max="64" step="1" />
          <input type="number" id="ma_ch_num" min="1" max="64" step="1" style="width: 80px" />
=======
        <div class="param">
          <label>Hardware Sampling Rate (kS/s)</label>
          <input type="range" id="fs_rate" min="10" max="1000" step="10" />
          <input type="number" id="fs_rate_num" min="10" max="1000" step="10" style="width: 90px" />
        </div>

        <div class="param">
          <label>CH Moving Avg (sec)</label>
          <input type="range" id="ma_ch_sec" min="0" max="0.1" step="0.001" />
          <input type="number" id="ma_ch_sec_num" min="0" max="0.1" step="0.001" style="width: 80px" />
        </div>
>>>>>>> Stashed changes

          <label>R Moving Avg (N)</label>
          <input type="range" id="ma_r" min="1" max="64" step="1" />
          <input type="number" id="ma_r_num" min="1" max="64" step="1" style="width: 80px" />

          <label>Target rate (S/s)</label>
          <input type="range" id="trate" min="10" max="2000" step="10" />
          <input type="number" id="trate_num" min="10" max="2000" step="10" style="width: 90px" />
        </div>

<<<<<<< Updated upstream
        <!-- ë²„íŠ¼ -->
        <div class="toolbar">
          <button id="apply" class="btn">ì ìš©</button>
          <button id="resetParams" class="btn">ì´ˆê¸°í™”</button>
=======
        <div class="param">
          <label>R Moving Avg (sec)</label>
          <input type="range" id="ma_r_sec" min="0" max="2" step="0.05" />
          <input type="number" id="ma_r_sec_num" min="0" max="2" step="0.05" style="width: 80px" />
>>>>>>> Stashed changes
        </div>

        <!-- í˜„ì¬ íŒŒë¼ë¯¸í„° ë·° -->
        <div class="muted parameter-view" id="paramsView"></div>
      </section>
    </main>

<<<<<<< Updated upstream
    <!-- README ëª¨ë‹¬ -->
<div id="readmeModal" class="modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h2>ğŸ“– ì‚¬ìš© ì•ˆë‚´</h2>
    <p>
      ì´ í˜ì´ì§€ëŠ” <strong>ì‹ í˜¸ì²˜ë¦¬ë³´ë“œ</strong>ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ
      ì‹œê°í™”/ì œì–´í•˜ëŠ” ì›¹ UIì…ë‹ˆë‹¤.<br>
      ì•„ë˜ 10ë‹¨ê³„ ì‹ í˜¸ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ì„ ë°˜ì˜í•©ë‹ˆë‹¤.
    </p>
    <ol>
      <li><b style="font-size: 1.1em;">Raw Data Acquisition</b> : 8ch PD ì‹ í˜¸, 100 kS/s</li>
      <li><b style="font-size: 1.1em;">Noise Filtering</b> : LPF / Smoothing (Cutoff ì¡°ì • ê°€ëŠ¥)</li>
      <li><b style="font-size: 1.1em;">ì‹œê°„í‰ê· (Time Avg)</b> : 100 kS/s â†’ Target rate (ì˜ˆ: 10 S/s)</li>
      <li><b style="font-size: 1.1em;">ë¹„ìœ¨ê³„ì‚°(R)</b> : 
          R = Î±Î²Î³k Ã— logâ‚–(<i>I_sensor</i> / <i>I_std</i>) + b<br>
          (ì„¼ì„œê°’ Ã· ê¸°ì¤€(ìŠ¤íƒ ë‹¤ë“œ) ê°’)</li>
      <li><b style="font-size: 1.1em;">ì´ë™í‰ê· (Ravg)</b> : ìœˆë„ìš° í¬ê¸° N ì¡°ì • ê°€ëŠ¥</li>
      <li><b style="font-size: 1.1em;">ë³´ì • í•¨ìˆ˜(y1)</b> : ë¶„ìëŠ” Ravg, ë¶„ëª¨ëŠ” ë‹¤í•­ì‹ ê³„ìˆ˜(y1_den)</li>
      <li><b style="font-size: 1.1em;">2ì°¨ ë³´ì •(y2)</b> : ë‹¤í•­ì‹ ê³„ìˆ˜ ê¸°ë°˜ (y2_coeffs)</li>
      <li><b style="font-size: 1.1em;">ì¶”ê°€ ë³´ì •(y3)</b> : ì„ íƒì  ë‹¤í•­ì‹ ê³„ìˆ˜ ì ìš© (y3_coeffs)</li>
      <li><b style="font-size: 1.1em;">Scaling (yt)</b> : yt = E Ã— y3 + F</li>
      <li><b style="font-size: 1.1em;">ì¶œë ¥</b> : 4ìŒ ì‹ í˜¸ (yt0~yt3), ì‹¤ì‹œê°„ Plot + WebSocket ì†¡ì¶œ</li>
    </ol>
=======
      <div class="toolbar">
        <button id="apply" class="btn">ì ìš©</button>
        <button id="resetParams" class="btn">ì´ˆê¸°í™”</button>
      </div>

      <div class="muted parameter-view" id="paramsView"></div>
    </section>
  </main>

  <!-- ===================== [í‘¸í„° ì˜ì—­] ===================== -->
 
>>>>>>> Stashed changes

  <!-- ===================== [ìŠ¤í¬ë¦½íŠ¸] ===================== -->
  <script type="module" src="/static/app.js"></script>

  <!-- ===================== [íƒ­ ì „í™˜ ìŠ¤í¬ë¦½íŠ¸] ===================== -->
  <script>
    const tabButtons = document.querySelectorAll(".tab-btn");
    const tabContents = document.querySelectorAll(".tab-content");

<<<<<<< Updated upstream
    <small style="color: gray; display: block; margin-top: 14px; line-height: 2.2; font-style: italic;">
      â€» Target Rate(ìƒ˜í”Œë§ ì†ë„)ëŠ” ë£¨í”„ ì²˜ë¦¬ëŸ‰ ì†ë„ì™€ ë‹¤ë¦…ë‹ˆë‹¤.<br>
      â€» y1 ê³„ì‚°ì—ì„œ ë¶„ìëŠ” í•­ìƒ Ravg, ë¶„ëª¨ëŠ” Denominator Coeffs(y1_den)ì…ë‹ˆë‹¤.
    </small>
  </div>
</div>



    <!-- ===================== [í‘¸í„° ì˜ì—­] ===================== -->
    <footer>Â© (ì£¼)AIM</footer>

    <!-- ===================== [ìŠ¤í¬ë¦½íŠ¸] ===================== -->
    <script type="module" src="/static/app.js"></script>

    <!-- í…Œë§ˆ í† ê¸€ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
      const themeToggle = document.getElementById("themeToggleInput");
      const body = document.body;

      function setTheme(theme) {
        if (theme === "gray") {
          body.classList.add("gray-mode");
          localStorage.setItem("theme", "gray");
          themeToggle.checked = true;
        } else {
          body.classList.remove("gray-mode");
          localStorage.setItem("theme", "dark");
          themeToggle.checked = false;
        }
      }

      themeToggle.addEventListener("change", () => {
        setTheme(themeToggle.checked ? "gray" : "dark");
=======
    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        tabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const targetId = btn.getAttribute("data-target");
        tabContents.forEach(sec => {
          sec.classList.toggle("active", sec.id === targetId);
        });
>>>>>>> Stashed changes
      });
    });
  </script>
</body>
</html>
